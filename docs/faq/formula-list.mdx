---
id: formula-list
title: List of Formulas and Functions
---

import useBaseUrl from "@docusaurus/useBaseUrl"; // Add to the top of the file below the front matter.

ValQ supports many traditional user-friendly functions that allows you
to create complex models. You may recognize many of these from your
experience with Microsoft Excel.

## Logical Functions

| **NAME**                                | **SYNTAX**                                                                                 | **DESCRIPTION**                                                                                                                                                                 |
| --------------------------------------- | ------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [IF](../references/formulas/if)         | If( logical_test, value_if_true, value_if_false )                                          | Checks whether a condition is met, and returns one value if TRUE, and another value if FALSE                                                                                    |
| [SWITCH](../references/formulas/switch) | SWITCH ( expression, value1, result1, value2, result2, ... value_n, result_n [, default] ) | Evaluates an expression against a list of values and returns the result corresponding to the first matching value. If there is no match, an optional default value is returned. |
| [AND](../references/formulas/and)       | AND( logical_test1, [logical_test2], ... )                                                 | Checks whether all the arguments are TRUE, and returns TRUE if all arguments are TRUE                                                                                           |
| [OR](../references/formulas/or)         | OR( logical_test1, [logical_test2], ... )                                                  | Checks whether any of the arguments are TRUE, and returns TRUE or FALSE. Returns FALSE only if all arguments are FALSE                                                          |
| [NOT](../references/formulas/not)       | NOT( logical_test )                                                                        | Changes FALSE to TRUE, or TRUE to FALSE                                                                                                                                         |
| [XOR](../references/formulas/xor)       | XOR( logical_test1, [logical_test2], ... )                                                 | Returns a logical 'Exclusive Or' of all arguments                                                                                                                               |

## Math Functions

| **NAME**                                                    | **SYNTAX**                            | **DESCRIPTION**                                                                                                               |
| ----------------------------------------------------------- | ------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------- |
| [SUM](../references/formulas/sum)                           | Sum(value1,[value2]....)              | Add all numbers in the arguments, which can be numbers or node references                                                     |
| [AVERAGE](../references/formulas/average)                   | Average(value1,[value2]....)          | Returns the average (arithmetic mean) of its arguments, which can be numbers or node references                               |
| [AVERAGEEXZERO](../references/formulas/averageexzero)       | AverageExZero(value1,[value2]....)    | Returns the average (arithmetic mean) of its arguments excluding zeros, which can be numbers or node references               |
| [AVERAGEEXNEG](../references/formulas/averageexneg)         | AverageExNeg(value1,[value2]....)     | Returns the average (arithmetic mean) of its arguments excluding negatives, which can be numbers or node references           |
| [AVERAGEEXZERONEG](../references/formulas/averageexzeroneg) | AverageExZeroNeg(value1,[value2]....) | Returns the average (arithmetic mean) of its arguments excluding zeros and negatives, which can be numbers or node references |
| [COUNT](../references/formulas/count)                       | Count(value1,[value2]....)            | Counts the number of items in a range                                                                                         |
| [ABS](../references/formulas/abs)                           | ABS(value)                            | Returns the absolute value of a number, a number without its sign                                                             |
| [MIN](../references/formulas/min)                           | Min(value1,[value2]....)              | Returns the smallest number in a set of values. Node references also accepted as arguments                                    |
| [MAX](../references/formulas/max)                           | Max(value1,[value2]....)              | Returns the largest number in a set of values. Node references also accepted as arguments                                     |
| [POWER](../references/formulas/power)                       | POW(value,power)                      | Returns the result of a number raised to a power                                                                              |
| [SQRT](../references/formulas/sqrt)                         | SQRT(value)                           | Returns the square root of a number                                                                                           |
| [EXP](../references/formulas/exp)                           | EXP(value)                            | Returns e raised to the power of a given number                                                                               |
| [LOG](../references/formulas/log)                           | LOG(value,base)                       | Returns the logarithm of a number to the base you specify                                                                     |

## Finance Functions

| **NAME**                                  | **SYNTAX**                                                | **DESCRIPTION**                                                                                                                                        |
| ----------------------------------------- | --------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| [IRR](../references/formulas/irr)         | IRR (Values, [Guess])                                     | Returns the internal rate of return for a series of cash flows. Node references also accepted as arguments                                             |
| [NPV](../references/formulas/npv)         | NPV (Rate, value1, [value2], ...)                         | Returns the net present value of an investment based on a discount rate and a series of future payments (negative values) and income (positive values) |
| [PMT](../references/formulas/pmt)         | PMT(Rate, Nper, PV, [FV], [Type])                         | Calculates the payment for a loan based on constant payments and a constant interest rate                                                              |
| [IPMT](../references/formulas/ipmt)       | IPMT (Rate, Per, Nper, PV, [FV], [Type])                  | Returns the interest payment for a given period for an investment,based on periodic, constant payments and a constant interest rate                    |
| [FV](../references/formulas/fv)           | FV (Rate, Nper, [Pmt], PV, [Type])                        | Returns the future value of an investment based on periodic, constant payments and a constant interest rate                                            |
| [PV](../references/formulas/pv)           | PV(Rate, Nper, [Pmt], FV, [Type])                         | Returns the present value of an investment                                                                                                             |
| [CUMIPMT](../references/formulas/cumipmt) | CUMIPMT (Rate, Nper, PV, start_period, end_period, Type)  | Returns the cumulative interest paid between two periods                                                                                               |
| [CMPRINC](../references/formulas/cmprinc) | CUMPRINC (Rate, Nper, PV, start_period, end_period, Type) | Returns the cumulative principal paid on a loan between two periods                                                                                    |
| [RATE](../references/formulas/rate)       | RATE(Nper, PMT, PV, [FV], [Type], [Guess])                | Returns the interest rate per period of a loan or an investment.                                                                                       |

## Range Functions

| **NAME**                                            | **SYNTAX**                    | **DESCRIPTION**   |
| --------------------------------------------------- | ----------------------------- | ----------------- |
| [Range](../references/formulas/range)               | .Range(start_index,end_index) |                   |
| [LastNPeriods](../references/formulas/lastnperiods) | .LastNPeriods(n)              |                   |
| [Get](../references/formulas/get)                   | .Get(period_index)            |                   |
| [ForEach](../references/formulas/foreach)           | ForEach(Array,Iterator)       | Iterator function |

## Static Identifiers And Other Formats

| **CONSTANTS**                                                                       | **EXPLANATION**                                       |
| ----------------------------------------------------------------------------------- | ----------------------------------------------------- |
| [THIS](../references/formulas/this)                                                 | Current Node                                          |
| [ME](../references/formulas/me)                                                     | Current Node                                          |
| [CURRENT_SERIES](../references/formulas/current_series)                             | Current series label                                  |
| [CURRENT_SERIES_ID ](../references/formulas/current_series_id)                      | Current series id                                     |
| [CURRENT_PERIOD_INDEX](../references/formulas/current_series)                       | Current period index                                  |
| [<NODE\>.PARENT](../references/formulas/node-properties)                            | Parent Node                                           |
| [<NODE\>.CHILDREN](../references/formulas/node-properties)                          | Node children                                         |
| [<NODE\>.act](../references/formulas/node-properties)                               | Simulated Series of the node                          |
| [<NODE\>.tgt ](../references/formulas/node-properties)                              | Comparison Series of the node                         |
| [<NODE\>.base ](../references/formulas/node-properties)                             | Baseline Series of the node                           |
| [<NODE\>.ALL_PERIODS](../references/formulas/node-properties)                       | Returns all Period values                             |
| [<NODE\>.SIM_PERIODS](../references/formulas/node-properties)                       | Returns simulation period values                      |
| [<NODE\>.act.ALL_PERIODS](../references/formulas/node-properties)                   | Returns all period values of Simulated Series,        |
| [<NODE\>.tgt.ALL_PERIODS ](../references/formulas/node-properties)                  | Returns all period values of Comparison Series        |
| [<NODE\>.base.ALL_PERIODS](../references/formulas/node-properties)                  | Returns all period values of Baseline Series          |
| [<NODE\>.act.SIM_PERIODS ](../references/formulas/node-properties)                  | Returns simulation period values of Simulated Series  |
| [<NODE\>.tgt.SIM_PERIODS ](../references/formulas/node-properties)                  | Returns simulation period values of Comparison Series |
| [<NODE\>.base.SIM_PERIODS](../references/formulas/node-properties)                  | Returns simulation period values of Baseline Series   |
| [<NODE\>.Range(start_index,end_index)](../references/formulas/node-properties)      | Returns selected range values                         |
| [<NODE\>.act.Range(start_index,end_index)](../references/formulas/node-properties)  | Returns selected range values of Simulated Series     |
| [<NODE\>.base.Range(start_index,end_index)](../references/formulas/node-properties) | Returns selected range values of Comparison Series    |
| [<NODE\>.tgt.Range(start_index,end_index)](../references/formulas/node-properties)  | Returns selected range values of Baseline Series      |
| [<NODE\>.Get(period_index) ](../references/formulas/node-properties)                | Returns selected period value                         |
| [<NODE\>.act.Get(period_index)](../references/formulas/node-properties)             | Returns selected period value of Simulated Series     |
| [<NODE\>.base.Get(period_index) ](../references/formulas/node-properties)           | Returns selected period value of Comparison Series    |
| [<NODE\>.tgt.Get(period_index)](../references/formulas/node-properties)             | Returns selected period value of Baseline Series      |
| [<NODE\>.LastNPeriods(n) ](../references/formulas/node-properties)                  | Returns selected range values                         |
| [<NODE\>.act.LastNPeriods(n) ](../references/formulas/node-properties)              | Returns selected range values of Simulated Series     |
| [<NODE\>.base.LastNPeriods(n) ](../references/formulas/node-properties)             | Returns selected range values of Comparison Series    |
| [<NODE\>.tgt.LastNPeriods(n) ](../references/formulas/node-properties)              | Returns selected range values of Baseline Series      |
